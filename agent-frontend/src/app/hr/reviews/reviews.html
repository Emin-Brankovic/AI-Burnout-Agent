<app-navbar></app-navbar>

<div class="reviews-container">
    <div class="reviews-header">
        <div class="reviews-title">
            <mat-icon class="title-icon">rate_review</mat-icon>
            <h2>Pending Reviews</h2>
        </div>
        <p class="reviews-subtitle">Validate AI predictions to improve system accuracy</p>
    </div>

    <div class="table-container mat-elevation-z2">
        <div class="loading-shade" *ngIf="isLoading">
            <mat-spinner diameter="40"></mat-spinner>
        </div>

        <table mat-table [dataSource]="dataSource">

            <!-- ID Column -->
            <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef> ID </th>
                <td mat-cell *matCellDef="let element"> #{{element.id}} </td>
            </ng-container>

            <!-- Date Column -->
            <ng-container matColumnDef="created_at">
                <th mat-header-cell *matHeaderCellDef> Date </th>
                <td mat-cell *matCellDef="let element"> {{element.created_at | date:'medium'}} </td>
            </ng-container>

            <!-- Prediction Type Column -->
            <ng-container matColumnDef="burnout_risk">
                <th mat-header-cell *matHeaderCellDef> Predicted Risk </th>
                <td mat-cell *matCellDef="let element">
                    <span class="status-badge" [ngClass]="getStatusClass(element.burnout_risk)">
                        {{element.burnout_risk}}
                    </span>
                </td>
            </ng-container>

            <!-- Confidence Column -->
            <ng-container matColumnDef="confidence">
                <th mat-header-cell *matHeaderCellDef> AI Confidence </th>
                <td mat-cell *matCellDef="let element">
                    <div class="confidence-wrapper">
                        <span>{{element.confidence_percentage}}</span>
                        <div class="confidence-bar">
                            <div class="confidence-fill" [style.width]="element.confidence_percentage"></div>
                        </div>
                    </div>
                </td>
            </ng-container>

            <!-- Actions Column -->
            <ng-container matColumnDef="actions">
                <th mat-header-cell *matHeaderCellDef> Actions </th>
                <td mat-cell *matCellDef="let element">
                    <button mat-stroked-button color="primary" (click)="reviewPrediction(element)">
                        Review
                    </button>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

            <!-- Row shown when there is no matching data. -->
            <tr class="mat-row" *matNoDataRow>
                <td class="mat-cell" colspan="5" style="text-align: center; padding: 2rem;">
                    No pending reviews found. Good job!
                </td>
            </tr>
        </table>

        <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" showFirstLastButtons aria-label="Select page of reviews">
        </mat-paginator>
    </div>
</div>
